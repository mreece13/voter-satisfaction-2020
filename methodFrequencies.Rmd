# Method Frequencies

## National

### Mode of Voting Frequencies

```{r national_votingMethod}

national_totals <- df %>% 
  group_by(votingMethod) %>% 
  tally() %>% 
  mutate(Percentage = round(100*n/sum(n), 2))

reactable(national_totals,
          columns = list(
            votingMethod = colDef(name = "Mode of Voting", footer = "Total"),
            n = colDef(footer = function(values) sum(values))
          ),
          defaultColDef = colDef(footerStyle = list(fontWeight = "bold")))

```

### Presidential Candidate Frequencies

```{r national_presCandidate}

national_presCandidate_totals <- df %>% 
  drop_na(Q6.5) %>% 
  group_by(Q6.5) %>% 
  tally() %>% 
  mutate(Percentage = round(100*n/sum(n), 2))

reactable(national_presCandidate_totals,
          columns = list(
            Q6.5 = colDef(name = "Presidential Candidate", footer = "Total"),
            n = colDef(footer = function(values) sum(values))
          ),
          defaultColDef = colDef(footerStyle = list(fontWeight = "bold")))

```

## By State

### Mode of Voting Frequencies

```{r state_votingMethod}

state_totals <- df %>% 
  group_by(state) %>%
  tally()

reactable(
  state_totals,
  details = function(index) {
    totals <- filter(df, state == state_totals$state[index]) %>% group_by(votingMethod) %>% tally() %>% mutate(Percentage = round(100*n/sum(n), 2)) %>% rename("Mode of Voting" = votingMethod)
    tbl <- reactable(totals, outlined = TRUE, highlight = TRUE, fullWidth = TRUE)
  },
  columns = list(
    state = colDef(name = "State")
  ),
  onClick = "expand",
  rowStyle = list(cursor = "pointer"),
  pagination = F
)

```

### Presidential Candidate Frequencies

```{r state_presCandidate}

state_presCandidate_totals <- df %>% 
  drop_na(Q6.5) %>% 
  group_by(state) %>%
  tally()

reactable(
  state_presCandidate_totals,
  details = function(index) {
    totals <- filter(df, state == state_presCandidate_totals$state[index]) %>% drop_na(Q6.5) %>% group_by(Q6.5) %>% tally() %>% mutate(Percentage = round(100*n/sum(n), 2)) %>% rename("Presidential Candidate" = Q6.5)
    tbl <- reactable(totals, outlined = TRUE, highlight = TRUE, fullWidth = TRUE)
  },
  columns = list(
    state = colDef(name = "State")
  ),
  onClick = "expand",
  rowStyle = list(cursor = "pointer"),
  pagination = F
)

```

## L2 Sample - National

### Mode of Voting Frequencies

```{r national_votingMethod_l2}

national_totals <- df %>% 
  filter(survey_origin == "l2") %>% 
  group_by(votingMethod) %>% 
  tally() %>% 
  mutate(Percentage = round(100*n/sum(n), 2))

reactable(national_totals,
          columns = list(
            votingMethod = colDef(name = "Mode of Voting", footer = "Total"),
            n = colDef(footer = function(values) sum(values))
          ),
          defaultColDef = colDef(footerStyle = list(fontWeight = "bold")))

```

### Presidential Candidate Frequencies

```{r national_presCandidate_l2}

national_presCandidate_totals <- df %>% 
  filter(survey_origin == "l2") %>% 
  drop_na(Q6.5) %>% 
  group_by(Q6.5) %>% 
  tally() %>% 
  mutate(Percentage = round(100*n/sum(n), 2))

reactable(national_presCandidate_totals,
          columns = list(
            Q6.5 = colDef(name = "Presidential Candidate", footer = "Total"),
            n = colDef(footer = function(values) sum(values))
          ),
          defaultColDef = colDef(footerStyle = list(fontWeight = "bold")))

```

## L2 Sample - By State

### Mode of Voting Frequencies

```{r state_votingMethod_l2}

state_totals <- df %>% 
  filter(survey_origin == "l2") %>% 
  group_by(state) %>%
  tally()

reactable(
  state_totals,
  details = function(index) {
    totals <- filter(df, state == state_totals$state[index]) %>% group_by(votingMethod) %>% tally() %>% mutate(Percentage = round(100*n/sum(n), 2)) %>% rename("Mode of Voting" = votingMethod)
    tbl <- reactable(totals, outlined = TRUE, highlight = TRUE, fullWidth = TRUE)
  },
  columns = list(
    state = colDef(name = "State")
  ),
  onClick = "expand",
  rowStyle = list(cursor = "pointer"),
  pagination = F
)

```

### Presidential Candidate Frequencies

```{r state_presCandidate_l2}

state_presCandidate_totals <- df %>% 
  filter(survey_origin == "l2") %>% 
  drop_na(Q6.5) %>% 
  group_by(state) %>%
  tally()

reactable(
  state_presCandidate_totals,
  details = function(index) {
    totals <- filter(df, state == state_presCandidate_totals$state[index]) %>% drop_na(Q6.5) %>% group_by(Q6.5) %>% tally() %>% mutate(Percentage = round(100*n/sum(n), 2)) %>% rename("Presidential Candidate" = Q6.5)
    tbl <- reactable(totals, outlined = TRUE, highlight = TRUE, fullWidth = TRUE)
  },
  columns = list(
    state = colDef(name = "State")
  ),
  onClick = "expand",
  rowStyle = list(cursor = "pointer"),
  pagination = F
)

```

## Dynata Sample - National

### Mode of Voting Frequencies

```{r national_votingMethod_dynata}

national_totals <- df %>% 
  filter(survey_origin == "dynata") %>% 
  group_by(votingMethod) %>% 
  tally() %>% 
  mutate(Percentage = round(100*n/sum(n), 2))

reactable(national_totals,
          columns = list(
            votingMethod = colDef(name = "Mode of Voting", footer = "Total"),
            n = colDef(footer = function(values) sum(values))
          ),
          defaultColDef = colDef(footerStyle = list(fontWeight = "bold")))

```

### Presidential Candidate Frequencies

```{r national_presCandidate_dynata}

national_presCandidate_totals <- df %>% 
  filter(survey_origin == "dynata") %>% 
  drop_na(Q6.5) %>% 
  group_by(Q6.5) %>% 
  tally() %>% 
  mutate(Percentage = round(100*n/sum(n), 2))

reactable(national_presCandidate_totals,
          columns = list(
            Q6.5 = colDef(name = "Presidential Candidate", footer = "Total"),
            n = colDef(footer = function(values) sum(values))
          ),
          defaultColDef = colDef(footerStyle = list(fontWeight = "bold")))

```

## Dynata Sample - By State

### Mode of Voting Frequencies

```{r state_votingMethod_dynata}

state_totals <- df %>% 
  filter(survey_origin == "dynata") %>% 
  group_by(state) %>%
  tally()

reactable(
  state_totals,
  details = function(index) {
    totals <- filter(df, state == state_totals$state[index]) %>% group_by(votingMethod) %>% tally() %>% mutate(Percentage = round(100*n/sum(n), 2)) %>% rename("Mode of Voting" = votingMethod)
    tbl <- reactable(totals, outlined = TRUE, highlight = TRUE, fullWidth = TRUE)
  },
  columns = list(
    state = colDef(name = "State")
  ),
  onClick = "expand",
  rowStyle = list(cursor = "pointer"),
  pagination = F
)

```

### Presidential Candidate Frequencies

```{r state_presCandidate_dynata}

state_presCandidate_totals <- df %>% 
  filter(survey_origin == "dynata") %>% 
  drop_na(Q6.5) %>% 
  group_by(state) %>%
  tally()

reactable(
  state_presCandidate_totals,
  details = function(index) {
    totals <- filter(df, state == state_presCandidate_totals$state[index]) %>% drop_na(Q6.5) %>% group_by(Q6.5) %>% tally() %>% mutate(Percentage = round(100*n/sum(n), 2)) %>% rename("Presidential Candidate" = Q6.5)
    tbl <- reactable(totals, outlined = TRUE, highlight = TRUE, fullWidth = TRUE)
  },
  columns = list(
    state = colDef(name = "State")
  ),
  onClick = "expand",
  rowStyle = list(cursor = "pointer"),
  pagination = F
)

```